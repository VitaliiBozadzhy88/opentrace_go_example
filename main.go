package main

import (
	"log"
	"net/http"

	"github.com/opentracing/opentracing-go"
	"traceWithGoV1/http/handlers"
	"traceWithGoV1/repository"
	"traceWithGoV1/tracing"
)

var repo *repository.Repository

func main() {
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	tracer, closer := tracing.Init("Get_email_service")
	defer closer.Close()
	opentracing.SetGlobalTracer(tracer)

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	repo = repository.NewRepository()
	defer repo.Close()
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	http.HandleFunc("/getPerson/", handlers.HandleGetPerson)
	log.Print("Listening on http://localhost:8080/")
	log.Fatal(http.ListenAndServe(":8080", nil))
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}
